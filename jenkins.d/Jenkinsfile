pipeline {
    agent any
    environment {
	NGINX_ROOT = '/home/jenkins/www'
	APP_PATH = '${NGINX_ROOT}/phpcart'
	APP_UPL = '${APP_PATH}/admin/uploads'
}
    stages {
        stage('Prepare') {
            steps {
		sh 'mkdir ${NGINX_ROOT}'
		sh 'cd ${NGINX_ROOT}' 
                sh 'git clone https://github.com/tomich/phpcart.git || true'
                sh 'git checkout'
                sh 'cd ${APP_PATH}'
                sh 'chmod -R 777 ${APP_UPL}'
            }
        }
        stage('start') {
            steps {
                sh 'cd /vagrant/docker-files'
                sh 'docker-compose up -d'
            }
        }
        stage('Test') {
            steps {
                sh 'echo "test ok :P"'
            }
        }
    }
}
